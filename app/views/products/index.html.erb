<h1 class="text-center"><%= t "products.index" %></h1>

<div class="text-center">
  <div class="dropdown categories">
    <button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown">
      <%= t "categories.menu" %><span class="caret"></span>
    </button>
    <ul class="dropdown-menu">
      <% Category.all.main_categories.each do |cat| %>
        <% if !cat.accessories.empty? %>
          <li class="dropdown-submenu">
            <a class="test" tabindex="-1">
              <%= link_to category_path(cat) do %>
                <%= cat.name %>
                <span class="caret"></span>
              <% end %>
            </a>
            <ul class="dropdown-menu">
              <% cat.accessories.each do |acc| %>
                <li><a tabindex="-1"><%= link_to acc.name, category_path(acc) %></a></li>
              <% end %>
            </ul>
          </li>
        <% else %>
          <li><a tabindex="-1"><%= link_to cat.name, category_path(cat) %></a></li>
        <% end %>
      <% end %>
    </ul>
  </div>

  <div class="search">
    <%= form_tag(products_path, method: "get", class: "navbar-form", id: "search") do %>
      <div class="input-group">
        <%= text_field_tag "search", params[:search],
          class: "form-control", placeholder: t("search") %>
        <span class="input-group-btn">
          <button class="btn btn-default" type="submit">
            <i class="glyphicon glyphicon-search"></i>
          </button>
        </span>
      </div>
    <% end %>
  </div>
</div>


<div id="products"><%= render partial: "products",
  locals: {products: @products} %></div>
